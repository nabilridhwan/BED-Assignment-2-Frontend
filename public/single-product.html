<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Product</title>
	<link rel="icon" href="img/Fevicon.png" type="image/png">
	<link rel="stylesheet" href="vendors/bootstrap/bootstrap.min.css">
	<link rel="stylesheet" href="vendors/fontawesome/css/all.min.css">
	<link rel="stylesheet" href="vendors/themify-icons/themify-icons.css">
	<link rel="stylesheet" href="vendors/linericon/style.css">
	<link rel="stylesheet" href="vendors/nice-select/nice-select.css">
	<link rel="stylesheet" href="vendors/owl-carousel/owl.theme.default.min.css">
	<link rel="stylesheet" href="vendors/owl-carousel/owl.carousel.min.css">

	<link rel="stylesheet" href="css/style.css">
</head>

<body>
	<!--================ Start Header Menu Area =================-->
	<header class="header_area">
		<div class="main_menu">
			<nav class="navbar navbar-expand-lg navbar-light">
				<div class="container">
					<a class="navbar-brand logo_h" href="index.html"><img src="img/logo.png" alt=""></a>
					<button class="navbar-toggler" type="button" data-toggle="collapse"
						data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
						aria-expanded="false" aria-label="Toggle navigation">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
						<ul class="nav navbar-nav menu_nav ml-auto mr-auto">
							<li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
							<li class="nav-item active submenu dropdown">
								<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button"
									aria-haspopup="true" aria-expanded="false">Shop</a>
								<ul class="dropdown-menu">
									<li class="nav-item"><a class="nav-link" href="category.html">Shop Category</a></li>
									<li class="nav-item"><a class="nav-link" href="single-product.html">Product
											Details</a></li>
									<li class="nav-item"><a class="nav-link" href="checkout.html">Product Checkout</a>
									</li>
									<li class="nav-item"><a class="nav-link" href="confirmation.html">Confirmation</a>
									</li>
									<li class="nav-item"><a class="nav-link" href="cart.html">Shopping Cart</a></li>
								</ul>
							</li>
							<li class="nav-item submenu dropdown">
								<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button"
									aria-haspopup="true" aria-expanded="false">Blog</a>
								<ul class="dropdown-menu">
									<li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
									<li class="nav-item"><a class="nav-link" href="single-blog.html">Blog Details</a>
									</li>
								</ul>
							</li>
							<li class="nav-item submenu dropdown">
								<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button"
									aria-haspopup="true" aria-expanded="false">Pages</a>
								<ul class="dropdown-menu">
									<li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
									<li class="nav-item"><a class="nav-link" href="register.html">Register</a></li>
									<li class="nav-item"><a class="nav-link" href="tracking-order.html">Tracking</a>
									</li>
								</ul>
							</li>
							<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
						</ul>

						<ul class="nav-shop">
							<li class="nav-item"><button><i class="ti-search"></i></button></li>
							<li class="nav-item"><button><i class="ti-shopping-cart"></i><span
										class="nav-shop__circle">3</span></button> </li>
							<li class="nav-item"><a class="button button-header" href="#">Buy Now</a></li>
						</ul>
					</div>
				</div>
			</nav>
		</div>
	</header>
	<!--================ End Header Menu Area =================-->

	<!--================Single Product Area =================-->
	<div class="product_image_area">
		<div class="container">
			<div class="row s_product_inner">
				<div class="col-lg-6">
					<!-- <div class="owl-carousel owl-theme s_Product_carousel"> -->

					<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
						<ol class="carousel-indicators">
							<li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
							<li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
							<li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
						</ol>


						<div class="carousel-inner">
						</div>


						<a class="carousel-control-prev" href="#carouselExampleIndicators" role="button"
							data-slide="prev">
							<span class="carousel-control-prev-icon" aria-hidden="true"></span>
							<span class="sr-only">Previous</span>
						</a>
						<a class="carousel-control-next" href="#carouselExampleIndicators" role="button"
							data-slide="next">
							<span class="carousel-control-next-icon" aria-hidden="true"></span>
							<span class="sr-only">Next</span>
						</a>
					</div>

					<!-- Intial image -->
					<!-- <div class="single-prd-item">
							<img class="img-fluid" src="img/category/s-p1.jpg" alt="">
						</div>
						<div class="single-prd-item">
							<img class="img-fluid" src="img/category/s-p1.jpg" alt="">
						</div>
						<div class="single-prd-item">
							<img class="img-fluid" src="img/category/s-p1.jpg" alt="">
						</div> -->
				</div>
				<!-- </div> -->
				<div class="col-lg-5 offset-lg-1">
					<div class="s_product_text">
						<h3 id="productTitle">Faded SkyBlu Denim Jeans</h3>
						<h2 id="productPrice">$149.99</h2>
						<ul class="list">
							<li><a class="active" href="#"><span>Category</span> : <span
										id="productCategory">Household</span></a></li>
							<li><a href="#"><span>Availibility</span> : In Stock</a></li>
						</ul>
						<p id="productDescription">Mill Oil is an innovative oil filled radiator with the most modern
							technology. If you are looking for
							something that can make your interior look awesome, and at the same time give you the
							pleasant warm feeling
							during the winter.</p>
						<div class="product_count">
							<label for="qty">Quantity:</label>
							<button
								onclick="var result = document.getElementById('sst'); var sst = result.value; if( !isNaN( sst )) result.value++;return false;"
								class="increase items-count" type="button"><i class="ti-angle-left"></i></button>
							<input type="text" name="qty" id="sst" size="2" maxlength="12" value="1" title="Quantity:"
								class="input-text qty">
							<button
								onclick="var result = document.getElementById('sst'); var sst = result.value; if( !isNaN( sst ) && sst > 0 ) result.value--;return false;"
								class="reduced items-count" type="button"><i class="ti-angle-right"></i></button>


							<a class="button primary-btn" id="addToCartButton" href="#">Add to Cart</a>

							<div class="adminEditButton admin-only">
							</div>

						</div>
						<div class="card_area d-flex align-items-center">
							<a class="icon_btn" href="#"><i class="lnr lnr lnr-diamond"></i></a>
							<a class="icon_btn" href="#"><i class="lnr lnr lnr-heart"></i></a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--================End Single Product Area =================-->

	<!--================Product Description Area =================-->
	<section class="product_description_area">
		<div class="container">
			<ul class="nav nav-tabs" id="myTab" role="tablist">
				<li class="nav-item">
					<a class="nav-link active" id="review-tab" data-toggle="tab" href="#review" role="tab"
						aria-controls="review" aria-selected="false">Reviews</a>
				</li>
			</ul>
			<div class="tab-content" id="myTabContent">
				<div class="tab-pane fade" id="home" role="tabpanel" aria-labelledby="home-tab">
					<p>Beryl Cook is one of Britain’s most talented and amusing artists .Beryl’s pictures feature women
						of all shapes
						and sizes enjoying themselves .Born between the two world wars, Beryl Cook eventually left
						Kendrick School in
						Reading at the age of 15, where she went to secretarial school and then into an insurance
						office. After moving to
						London and then Hampton, she eventually married her next door neighbour from Reading, John Cook.
						He was an
						officer in the Merchant Navy and after he left the sea in 1956, they bought a pub for a year
						before John took a
						job in Southern Rhodesia with a motor company. Beryl bought their young son a box of
						watercolours, and when
						showing him how to use it, she decided that she herself quite enjoyed painting. John
						subsequently bought her a
						child’s painting set for her birthday and it was with this that she produced her first
						significant work, a
						half-length portrait of a dark-skinned lady with a vacant expression and large drooping breasts.
						It was aptly
						named ‘Hangover’ by Beryl’s husband and</p>
					<p>It is often frustrating to attempt to plan meals that are designed for one. Despite this fact, we
						are seeing
						more and more recipe books and Internet websites that are dedicated to the act of cooking for
						one. Divorce and
						the death of spouses or grown children leaving for college are all reasons that someone
						accustomed to cooking for
						more than one would suddenly need to learn how to adjust all the cooking practices utilized
						before into a
						streamlined plan of cooking that is more efficient for one person creating less</p>
				</div>
				<div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
					<div class="table-responsive">
						<table class="table">
							<tbody>
								<tr>
									<td>
										<h5>Width</h5>
									</td>
									<td>
										<h5>128mm</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>Height</h5>
									</td>
									<td>
										<h5>508mm</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>Depth</h5>
									</td>
									<td>
										<h5>85mm</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>Weight</h5>
									</td>
									<td>
										<h5>52gm</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>Quality checking</h5>
									</td>
									<td>
										<h5>yes</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>Freshness Duration</h5>
									</td>
									<td>
										<h5>03days</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>When packeting</h5>
									</td>
									<td>
										<h5>Without touch of hand</h5>
									</td>
								</tr>
								<tr>
									<td>
										<h5>Each Box contains</h5>
									</td>
									<td>
										<h5>60pcs</h5>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
					<div class="row">
						<div class="col-lg-6">
							<div class="comment_list">
								<div class="review_item">
									<div class="media">
										<div class="d-flex">
											<img src="img/product/review-1.png" alt="">
										</div>
										<div class="media-body">
											<h4>Blake Ruiz</h4>
											<h5>12th Feb, 2018 at 05:56 pm</h5>
											<a class="reply_btn" href="#">Reply</a>
										</div>
									</div>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et
										dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
										laboris nisi ut aliquip ex ea
										commodo</p>
								</div>
								<div class="review_item reply">
									<div class="media">
										<div class="d-flex">
											<img src="img/product/review-2.png" alt="">
										</div>
										<div class="media-body">
											<h4>Blake Ruiz</h4>
											<h5>12th Feb, 2018 at 05:56 pm</h5>
											<a class="reply_btn" href="#">Reply</a>
										</div>
									</div>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et
										dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
										laboris nisi ut aliquip ex ea
										commodo</p>
								</div>
								<div class="review_item">
									<div class="media">
										<div class="d-flex">
											<img src="img/product/review-3.png" alt="">
										</div>
										<div class="media-body">
											<h4>Blake Ruiz</h4>
											<h5>12th Feb, 2018 at 05:56 pm</h5>
											<a class="reply_btn" href="#">Reply</a>
										</div>
									</div>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et
										dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
										laboris nisi ut aliquip ex ea
										commodo</p>
								</div>
							</div>
						</div>
						<div class="col-lg-6">
							<div class="review_box">
								<h4>Post a comment</h4>

								<div class="review_content">
									<form class="row contact_form" action="contact_process.php" method="post"
										id="contactForm" novalidate="novalidate">
										<div class="col-md-12">
											<div class="form-group">
												<input type="text" class="form-control" id="name" name="name"
													placeholder="Your Full name">
											</div>
										</div>
										<div class="col-md-12">
											<div class="form-group">
												<input type="email" class="form-control" id="email" name="email"
													placeholder="Email Address">
											</div>
										</div>
										<div class="col-md-12">
											<div class="form-group">
												<input type="text" class="form-control" id="number" name="number"
													placeholder="Phone Number">
											</div>
										</div>
										<div class="col-md-12">
											<div class="form-group">
												<textarea class="form-control" name="message" id="message" rows="1"
													placeholder="Message"></textarea>
											</div>
										</div>
										<div class="col-md-12 text-right">
											<button type="submit" value="submit" class="btn primary-btn">Submit
												Now</button>
										</div>
									</form>
								</div>

							</div>
						</div>
					</div>
				</div>
				<div class="tab-pane fade show active" id="review" role="tabpanel" aria-labelledby="review-tab">
					<div class="row">
						<div class="col-lg-6">
							<div class="row total_rate">
								<div class="col-6">
									<div class="box_total">
										<h5>Overall</h5>
										<h4 id="averageRating">4.0</h4>
										<h6>(<span class="numberOfReviews">03</span> Reviews)</h6>
									</div>
								</div>
								<div class="col-6">
									<div class="rating_list">
										<h3>Based on <span class="numberOfReviews">3</span> Reviews</h3>
										<ul class="list">
											<li><a href="#">5 Star
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i> <span
														id="numberOfFiveStarRatings">01</span></a>
											</li>

											<li><a href="#">4 Star
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i> <span
														id="numberOfFourStarRatings">01</span></a>
											</li>

											<li><a href="#">3 Star
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i> <span
														id="numberOfThreeStarRatings">01</span></a>
											</li>

											<li><a href="#">2 Star
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i> <span
														id="numberOfTwoStarRatings">01</span></a>
											</li>

											<li><a href="#">1 Star
													<i class="fa fa-star"></i> <span
														id="numberOfOneStarRatings">01</span></a>
											</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="review_list">
								<div class="review_item">
									<div class="media">
										<div class="d-flex">
											<img src="img/product/review-1.png" alt="">
										</div>
										<div class="media-body">
											<h4>Blake Ruiz</h4>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
										</div>
									</div>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et
										dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
										laboris nisi ut aliquip ex ea
										commodo</p>
								</div>
								<div class="review_item">
									<div class="media">
										<div class="d-flex">
											<img src="img/product/review-2.png" alt="">
										</div>
										<div class="media-body">
											<h4>Blake Ruiz</h4>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
										</div>
									</div>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et
										dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
										laboris nisi ut aliquip ex ea
										commodo</p>
								</div>
								<div class="review_item">
									<div class="media">
										<div class="d-flex">
											<img src="img/product/review-3.png" alt="">
										</div>
										<div class="media-body">
											<h4>Blake Ruiz</h4>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
											<i class="fa fa-star"></i>
										</div>
									</div>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et
										dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
										laboris nisi ut aliquip ex ea
										commodo</p>
								</div>
							</div>
						</div>
						<div class="col-lg-6">
							<div class="review_box">
								<h4>Add a Review</h4>
								<p id="errorMessage" class="text-danger"></p>
								<!-- <p>Your Rating:</p>
								<ul class="list">
									<li><a href="#"><i class="fa fa-star"></i></a></li>
									<li><a href="#"><i class="fa fa-star"></i></a></li>
									<li><a href="#"><i class="fa fa-star"></i></a></li>
									<li><a href="#"><i class="fa fa-star"></i></a></li>
									<li><a href="#"><i class="fa fa-star"></i></a></li>
								</ul> -->
								<!-- <p>Outstanding</p> -->
								<form action="#/" class="form-contact form-review mt-3" id="submitForm">

									<div class="form-group">
										<input class="form-control" type="number" id="rating" min="1" max="5"
											placeholder="Enter your rating (1-5)">
									</div>

									<div class="form-group">
										<textarea class="form-control different-control w-100" name="textarea"
											id="reviewText" cols="30" rows="5" placeholder="Enter Review"></textarea>
									</div>
									<div class="form-group text-center text-md-right mt-3">
										<button type="submit" class="button button--active button-review">Submit
											Now</button>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!--================End Product Description Area =================-->

	<!--================ Start footer Area  =================-->
	<footer>
		<div class="footer-area footer-only">
			<div class="container">
				<div class="row section_gap">
					<div class="col-lg-3 col-md-6 col-sm-6">
						<div class="single-footer-widget tp_widgets ">
							<h4 class="footer_title large_title">Our Mission</h4>
							<p>
								So seed seed green that winged cattle in. Gathering thing made fly you're no
								divided deep moved us lan Gathering thing us land years living.
							</p>
							<p>
								So seed seed green that winged cattle in. Gathering thing made fly you're no divided
								deep moved
							</p>
						</div>
					</div>
					<div class="offset-lg-1 col-lg-2 col-md-6 col-sm-6">
						<div class="single-footer-widget tp_widgets">
							<h4 class="footer_title">Quick Links</h4>
							<ul class="list">
								<li><a href="#">Home</a></li>
								<li><a href="#">Shop</a></li>
								<li><a href="#">Blog</a></li>
								<li><a href="#">Product</a></li>
								<li><a href="#">Brand</a></li>
								<li><a href="#">Contact</a></li>
							</ul>
						</div>
					</div>
					<div class="col-lg-2 col-md-6 col-sm-6">
						<div class="single-footer-widget instafeed">
							<h4 class="footer_title">Gallery</h4>
							<ul class="list instafeed d-flex flex-wrap">
								<li><img src="img/gallery/r1.jpg" alt=""></li>
								<li><img src="img/gallery/r2.jpg" alt=""></li>
								<li><img src="img/gallery/r3.jpg" alt=""></li>
								<li><img src="img/gallery/r5.jpg" alt=""></li>
								<li><img src="img/gallery/r7.jpg" alt=""></li>
								<li><img src="img/gallery/r8.jpg" alt=""></li>
							</ul>
						</div>
					</div>
					<div class="offset-lg-1 col-lg-3 col-md-6 col-sm-6">
						<div class="single-footer-widget tp_widgets">
							<h4 class="footer_title">Contact Us</h4>
							<div class="ml-40">
								<p class="sm-head">
									<span class="fa fa-location-arrow"></span>
									Head Office
								</p>
								<p>123, Main Street, Your City</p>

								<p class="sm-head">
									<span class="fa fa-phone"></span>
									Phone Number
								</p>
								<p>
									+123 456 7890 <br>
									+123 456 7890
								</p>

								<p class="sm-head">
									<span class="fa fa-envelope"></span>
									Email
								</p>
								<p>
									free@infoexample.com <br>
									www.infoexample.com
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="footer-bottom">
			<div class="container">
				<div class="row d-flex">
					<p class="col-lg-12 footer-text text-center">
						<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
						Copyright &copy;<script>
							document.write(new Date().getFullYear());
						</script> All rights reserved | This template is made with <i class="fa fa-heart"
							aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
						<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
					</p>
				</div>
			</div>
		</div>
	</footer>
	<!--================ End footer Area  =================-->



	<script src="vendors/jquery/jquery-3.2.1.min.js"></script>
	<script src="vendors/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="vendors/skrollr.min.js"></script>
	<script src="vendors/owl-carousel/owl.carousel.min.js"></script>
	<script src="vendors/nice-select/jquery.nice-select.min.js"></script>
	<script src="vendors/jquery.ajaxchimp.min.js"></script>
	<script src="vendors/mail-script.js"></script>
	<script src="js/cart_storage.js"></script>
	<script src="js/main.js"></script>

	<script>
		const carousel = $(".carousel-inner")
		const searchQuery = new URLSearchParams(window.location.search);

		const productid = searchQuery.get("productid");
		const errorMessage = $("#errorMessage")

		// Init the cart if not done
		getCart();

		// If user is not signed in
		if (HasTokenExpired(localStorage, "expires")) {
			$(".review_box").html(
				`
					<h4><a href="/login">Login</a> to review products</h4>	
				`
			);
		}

		if (localStorage.getItem("type") == "Admin") {
			$(".adminEditButton").append(
				`

							<a class="button primary-btn" href="/product?action=edit&productid=${productid}">Edit Product</a>
				`
			)
		}

		$("#addToCartButton").click(async (e) => {
			e.preventDefault();
			const quantity = parseInt($("#sst").val());
			const discounts = await getDiscount(productid)
			let discount_id = null;

			if (discounts.length > 0) {
				discount_id = discounts[0].discount_id;
			}

			const product = {
				productid,
				discount_id: discount_id,
				quantity,
			}

			console.log(product)
			addItemToCart(product);

			alert("Item added to cart!")
		})

		if (productid) {
			//   Fetch the product
			fetch(`${BACKEND_URL}/product/${productid}`)
				.then(res => {
					if (res.ok) {
						return res.json();
					}

					throw new Error(res.status)
				}).then(async data => {
					const product = data[0]
					let {
						brand,
						categoryid,
						categoryname,
						description,
						name,
						price
					} = product;

					document.title = name;

					const discounts = await getDiscount(productid)

					console.log(discounts)

					if (discounts && discounts.length > 0) {
						price = discounts[0].price
					}

					$("#productTitle").text(name);
					$("#productPrice").text(`$${roundToTwo(price)}`);
					$("#productDescription").text(description);
					$("#productCategory").text(categoryname);

				})

			fetch(`${BACKEND_URL}/product/${productid}/image`)
				.then(res => {
					if (res.ok) {
						return res.json();
					}

					throw new Error(res.status)
				}).then(images => {

					// Empty the carousel and carousel indicators
					carousel.empty();
					$(".carousel-indicators").empty();

					if (images.length > 0) {

						images.forEach((src, index) => {
							const imgTemplate = `
								<div class="carousel-item ${index == 0 && "active"}">
										<img class="d-block img-fluid product-image" src="${src}" alt="First slide">
								</div>
								`



							const indicator =
								`<li data-target="#carouselExampleIndicators" data-slide-to="${index}" ${index == 0 && "class='active'"}></li>`

							$(".carousel-indicators").append(indicator)
							carousel.append(imgTemplate)
						})
					} else {
						const imgTemplate = `
								<div class="carousel-item active"}">
										<img class="d-block img-fluid product-image" src="https://via.placeholder.com/512" alt="First slide">
								</div>
								`



						const indicator =
							`<li data-target="#carouselExampleIndicators" data-slide-to="0" class='active'}></li>`



						$(".carousel-indicators").append(indicator)
						carousel.append(imgTemplate)
					}
				})

			fetch(`${BACKEND_URL}/product/${productid}/review`)
				.then(res => {
					if (res.ok) {
						return res.json()
					}

					throw new Error(res.status)
				}).then(reviews => {
					const numberOfReviews = reviews.length;
					$(".review_list").empty();

					if (numberOfReviews > 0) {

						const averageReview = reviews.reduce((acc, curr) => acc + curr.rating, 0) / numberOfReviews;

						// Round the averageReview to 1 decimal place
						const roundedAverageReview = Math.round(averageReview * 10) / 10;

						$(".numberOfReviews").text(numberOfReviews);
						$("#averageRating").text(roundedAverageReview);
						console.log(roundedAverageReview)



						let totalRating = {
							"1": 0,
							"2": 0,
							"3": 0,
							"4": 0,
							"5": 0
						}


						reviews.forEach(r => {
							const {
								rating,
								review,
								username,
								userid
							} = r;

							totalRating[rating]++;

							fetch(`${BACKEND_URL}/users/${userid}`)
								.then(res => res.json())
								.then(([user]) => {

									let img =
										`<img src="https://via.placeholder.com/70" class="rounded-circle" alt="Profile Picture">`

									if (user.profile_pic_url) {
										img =
											`<img src="${user.profile_pic_url}" width="70" height="70" class="rounded-circle" alt="Profile Picture">`
									}


									$(".review_list").append(
										`
								<div class="review_item">
									<div class="media">
										<div class="d-flex">
											${img}
										</div>
										<div class="media-body">
											<h4>${username}</h4>

											${duplicateString(`<i class="fa fa-star"></i>`,rating)}
										</div>
									</div>
									<p>${review}</p>
								</div>
							`
									)
								})
						})


						$("#numberOfFiveStarRatings").text(formatNumber(totalRating["5"]));
						$("#numberOfFourStarRatings").text(formatNumber(totalRating["4"]));
						$("#numberOfThreeStarRatings").text(formatNumber(totalRating["3"]));
						$("#numberOfTwoStarRatings").text(formatNumber(totalRating["2"]));
						$("#numberOfOneStarRatings").text(formatNumber(totalRating["1"]));
					} else {
						// No reviews
						// Change average rating to 0
						$("#averageRating").text(0);
						// Change number of reviews to 0
						$(".numberOfReviews").text(0);

						// Change every numbeer to 0
						$("#numberOfFiveStarRatings").text(0);
						$("#numberOfFourStarRatings").text(0);
						$("#numberOfThreeStarRatings").text(0);
						$("#numberOfTwoStarRatings").text(0);
						$("#numberOfOneStarRatings").text(0);

						// Append a h4 to the review list saying no reviews
						$(".review_list").append(
							`
							<h4>No reviews yet</h4>
						`
						)
					}

				})

			// SUBMIT FORM
			$("#submitForm").submit(e => {
				errorMessage.text("")
				e.preventDefault();


				const reviewText = $("#reviewText").val()
				const ratingText = $("#rating").val()

				if (reviewText != "" && ratingText.length > 0) {
					fetch(`${BACKEND_URL}/product/${productid}/review`, {
							method: "POST",
							headers: {
								"Content-Type": "application/json",
								"Authorization": `Bearer ${localStorage.getItem("token")}`
							},
							body: JSON.stringify({
								review: reviewText,
								rating: ratingText
							})
						})
						.then(res => {
							if (res.ok) {
								// Refresh the page
								location.reload();
							} else {
								errorMessage.text("Something went wrong in posting your review")
								throw new Error(res.status)
							}
						})
				}else{
					errorMessage.text("Please fill in all fields")
				}
			})

			const formatNumber = (n) => n < 10 ? `0${n}` : n;

			// Write a function to duplicate strings and return as one that uses an input of number
			// of times to duplicate the string

			function duplicateString(str, times) {
				let result = "";

				for (let i = 0; i < times; i++) {
					result += str;
				}

				return result;
			}

		} else {
			// Redirect to login page
			window.location.href = "/products";
		}

		async function getDiscount(productid) {
			return new Promise((resolve, reject) => {
				fetch(`${BACKEND_URL}/discount/${productid}`)
					.then(res => {
						if (!res.ok) {
							throw new Error(res.status)
						}

						return res.json();
					}).then(data => {
						let sortedDiscounts = data.sort((a, b) => {
							return a.price - b.price
						})

						resolve(sortedDiscounts);
					}).catch(e => {
						reject(e);
					})
			})
		}
	</script>
</body>

</html>